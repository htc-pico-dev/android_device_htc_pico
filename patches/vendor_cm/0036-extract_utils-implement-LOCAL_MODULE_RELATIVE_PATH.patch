From 95450e6f28cf8906ff3f2c2c62f16882b446d445 Mon Sep 17 00:00:00 2001
From: M1cha <sigmaepsilon92@gmail.com>
Date: Wed, 4 Jan 2017 09:00:11 +0100
Subject: [PATCH 36/39] extract_utils: implement LOCAL_MODULE_RELATIVE_PATH

Change-Id: Ia97633652ff9647a6e82013b208097be5c5575a9
---
 build/tools/extract_utils.sh | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/build/tools/extract_utils.sh b/build/tools/extract_utils.sh
index b7350734..239de357 100644
--- a/build/tools/extract_utils.sh
+++ b/build/tools/extract_utils.sh
@@ -221,6 +221,7 @@ function write_packages() {
         ARGS=$(target_args "$P")
 
         BASENAME=$(basename "$FILE")
+        DIRNAME=$(dirname "$FILE")
         EXTENSION=${BASENAME##*.}
         PKGNAME=${BASENAME%.*}
 
@@ -301,6 +302,11 @@ function write_packages() {
         if [ ! -z "$EXTENSION" ]; then
             printf 'LOCAL_MODULE_SUFFIX := .%s\n' "$EXTENSION"
         fi
+        if [ "$CLASS" = "SHARED_LIBRARIES" ] || [ "$CLASS" = "EXECUTABLES" ]; then
+            if [ "$DIRNAME" != "." ]; then
+                printf 'LOCAL_MODULE_RELATIVE_PATH := %s\n' "$DIRNAME"
+            fi
+        fi
         if [ "$EXTRA" = "priv-app" ]; then
             printf 'LOCAL_PRIVILEGED_MODULE := true\n'
         fi
-- 
2.15.0

